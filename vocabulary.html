<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Korean Vocabulary App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    animation: {
                        'spin-slow': 'spin 2s linear infinite',
                        'bounce-in': 'bounceIn 0.6s ease-out',
                        'slide-up': 'slideUp 0.3s ease-out'
                    },
                    keyframes: {
                        bounceIn: {
                            '0%': { transform: 'scale(0.3)', opacity: '0' },
                            '50%': { transform: 'scale(1.05)' },
                            '70%': { transform: 'scale(0.9)' },
                            '100%': { transform: 'scale(1)', opacity: '1' }
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(20px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' }
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gradient-to-br from-purple-600 via-blue-600 to-indigo-700 min-h-screen">
    <div class="container mx-auto px-4 py-6 max-w-md">
        <!-- Header -->
        <div class="bg-gradient-to-r from-pink-500 to-rose-500 rounded-t-3xl text-white p-8 text-center shadow-xl">
            <h1 class="text-2xl font-bold mb-2">üá∞üá∑ Korean Vocabulary</h1>
            <p class="text-pink-100 text-sm">Learn Korean words by category</p>
        </div>

        <!-- Main Content Container -->
        <div class="bg-white rounded-b-3xl shadow-xl overflow-hidden">
            <!-- Loading State -->
            <div id="loading" class="text-center py-16">
                <div class="w-12 h-12 border-4 border-purple-200 border-t-purple-600 rounded-full animate-spin mx-auto mb-4"></div>
                <p class="text-gray-600">Loading vocabulary...</p>
            </div>

            <!-- Error State -->
            <div id="error" class="text-center py-16 hidden">
                <div class="text-6xl mb-4">‚ùå</div>
                <p class="text-red-600 mb-4">Failed to load vocabulary data</p>
                <button onclick="loadVocabulary()" class="bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-full transition-colors">
                    Try Again
                </button>
            </div>

            <!-- Content -->
            <div id="content" class="hidden">
                <!-- Stats -->
                <div id="stats" class="bg-gray-50 px-6 py-4 text-center text-gray-600 text-sm border-b"></div>
                
                <!-- Categories -->
                <div id="categories" class="p-4 space-y-4 max-h-96 overflow-y-auto"></div>
            </div>
        </div>

        <!-- Quiz Modal -->
        <div id="quizModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-3xl max-w-sm w-full mx-4 overflow-hidden animate-bounce-in">
                <!-- Quiz Header -->
                <div class="bg-gradient-to-r from-emerald-500 to-teal-500 text-white p-6 text-center">
                    <h2 id="quizTitle" class="text-xl font-bold mb-2">Quiz Time! üß†</h2>
                    <div class="flex justify-between text-sm text-emerald-100">
                        <span id="quizProgress">Question 1 of 5</span>
                        <span id="quizScore">Score: 0</span>
                    </div>
                </div>

                <!-- Quiz Content -->
                <div class="p-6">
                    <div id="quizQuestion" class="text-center mb-6">
                        <div class="text-3xl font-bold text-gray-800 mb-2" id="questionWord">ÏïàÎÖïÌïòÏÑ∏Ïöî</div>
                        <p class="text-gray-600">What does this Korean word mean?</p>
                    </div>

                    <!-- Quiz Options -->
                    <div id="quizOptions" class="space-y-3 mb-6">
                        <!-- Options will be inserted here -->
                    </div>

                    <!-- Quiz Result -->
                    <div id="quizResult" class="text-center hidden">
                        <div id="resultIcon" class="text-6xl mb-4">üéâ</div>
                        <div id="resultText" class="text-xl font-bold mb-4">Excellent!</div>
                        <div id="finalScore" class="text-gray-600 mb-6">You scored 4 out of 5!</div>
                        <div class="space-y-3">
                            <button onclick="restartQuiz()" class="w-full bg-emerald-500 hover:bg-emerald-600 text-white py-3 rounded-xl transition-colors">
                                Try Again
                            </button>
                            <button onclick="closeQuiz()" class="w-full bg-gray-500 hover:bg-gray-600 text-white py-3 rounded-xl transition-colors">
                                Back to Categories
                            </button>
                        </div>
                    </div>

                    <!-- Quiz Controls -->
                    <div id="quizControls" class="flex gap-3">
                        <button onclick="closeQuiz()" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-3 rounded-xl transition-colors">
                            Close
                        </button>
                        <button id="nextButton" onclick="nextQuestion()" class="flex-1 bg-emerald-500 hover:bg-emerald-600 text-white py-3 rounded-xl transition-colors hidden">
                            Next
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let vocabularyData = [];
        let categorizedWords = {};
        let currentQuiz = null;

        async function loadVocabulary() {
            const loadingEl = document.getElementById('loading');
            const errorEl = document.getElementById('error');
            const contentEl = document.getElementById('content');
            
            loadingEl.classList.remove('hidden');
            errorEl.classList.add('hidden');
            contentEl.classList.add('hidden');

            try {
                const response = await fetch('https://docs.google.com/spreadsheets/d/e/2PACX-1vRcnPTDqplxkiDDcKiZV3chp0BqxnhZuXcxoPSH-mmcFJlhlCAIZ7rCBa09KkaCPcgRKTggKOMv6m6s/pub?output=csv');
                
                if (!response.ok) {
                    throw new Error('Failed to fetch data');
                }

                const csvText = await response.text();
                parseCSVData(csvText);
                renderCategories();
                
                loadingEl.classList.add('hidden');
                contentEl.classList.remove('hidden');
                
            } catch (error) {
                console.error('Error loading vocabulary:', error);
                loadingEl.classList.add('hidden');
                errorEl.classList.remove('hidden');
            }
        }

        function parseCSVData(csvText) {
            const lines = csvText.split('\n');
            vocabularyData = [];
            categorizedWords = {};

            for (let i = 1; i < lines.length; i++) {
                const line = lines[i].trim();
                if (!line) continue;

                const columns = line.split(',').map(col => col.trim().replace(/^"|"$/g, ''));
                
                if (columns.length >= 3) {
                    const korean = columns[0];
                    const english = columns[1];
                    const category = columns[2] || 'Other';

                    if (korean && english) {
                        const word = { korean, english, category };
                        vocabularyData.push(word);

                        if (!categorizedWords[category]) {
                            categorizedWords[category] = [];
                        }
                        categorizedWords[category].push(word);
                    }
                }
            }
        }

        function renderCategories() {
            const categoriesEl = document.getElementById('categories');
            const statsEl = document.getElementById('stats');
            
            const totalWords = vocabularyData.length;
            const totalCategories = Object.keys(categorizedWords).length;
            statsEl.innerHTML = `üìö ${totalWords} words in ${totalCategories} categories`;

            categoriesEl.innerHTML = '';

            const sortedCategories = Object.keys(categorizedWords).sort();

            sortedCategories.forEach(category => {
                const words = categorizedWords[category];
                const categoryCard = createCategoryCard(category, words);
                categoriesEl.appendChild(categoryCard);
            });
        }

        function createCategoryCard(category, words) {
            const card = document.createElement('div');
            card.className = 'bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl border border-blue-100 overflow-hidden hover:shadow-lg transition-all duration-300 hover:-translate-y-1';

            card.innerHTML = `
                <div class="bg-gradient-to-r from-blue-500 to-indigo-600 text-white p-4 cursor-pointer" onclick="toggleCategory('${category}')">
                    <div class="flex justify-between items-center">
                        <span class="font-semibold text-lg">${category}</span>
                        <div class="flex items-center gap-3">
                            <span class="bg-white bg-opacity-20 px-3 py-1 rounded-full text-sm">${words.length} words</span>
                            <span class="expand-icon transition-transform duration-300">‚ñº</span>
                        </div>
                    </div>
                </div>
                
                <div class="words-list max-h-0 overflow-hidden transition-all duration-300">
                    <div class="p-4 space-y-3">
                        ${words.map(word => `
                            <div class="flex justify-between items-center p-3 bg-white rounded-xl hover:bg-blue-50 transition-colors">
                                <span class="font-semibold text-gray-800 text-lg">${word.korean}</span>
                                <span class="text-gray-600">${word.english}</span>
                            </div>
                        `).join('')}
                        <button onclick="startQuiz('${category}')" class="w-full bg-gradient-to-r from-emerald-500 to-teal-500 hover:from-emerald-600 hover:to-teal-600 text-white py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105">
                            üß† Start Quiz
                        </button>
                    </div>
                </div>
            `;

            return card;
        }

        function toggleCategory(category) {
            const cards = document.querySelectorAll('.bg-gradient-to-r.from-blue-50');
            cards.forEach(card => {
                const header = card.querySelector('.bg-gradient-to-r.from-blue-500');
                if (header && header.textContent.includes(category)) {
                    const wordsList = card.querySelector('.words-list');
                    const expandIcon = card.querySelector('.expand-icon');
                    
                    if (wordsList.style.maxHeight === '0px' || !wordsList.style.maxHeight) {
                        wordsList.style.maxHeight = '100000px';
                        expandIcon.style.transform = 'rotate(180deg)';
                    } else {
                        wordsList.style.maxHeight = '0px';
                        expandIcon.style.transform = 'rotate(0deg)';
                    }
                }
            });
        }

        function startQuiz(category) {
            const words = categorizedWords[category];
            if (!words || words.length < 2) {
                alert('Not enough words in this category for a quiz!');
                return;
            }

            currentQuiz = {
                category: category,
                words: [...words].sort(() => Math.random() - 0.5), // Shuffle words
                currentQuestion: 0,
                score: 0,
                totalQuestions: Math.min(5, words.length),
                answered: false
            };

            document.getElementById('quizModal').classList.remove('hidden');
            document.getElementById('quizModal').classList.add('flex');
            showQuestion();
        }

        function showQuestion() {
            const quiz = currentQuiz;
            const currentWord = quiz.words[quiz.currentQuestion];
            
            document.getElementById('quizTitle').textContent = `${quiz.category} Quiz üß†`;
            document.getElementById('quizProgress').textContent = `Question ${quiz.currentQuestion + 1} of ${quiz.totalQuestions}`;
            document.getElementById('quizScore').textContent = `Score: ${quiz.score}`;
            document.getElementById('questionWord').textContent = currentWord.korean;
            
            // Generate options (correct answer + 3 random wrong answers)
            const options = [currentWord.english];
            const otherWords = quiz.words.filter(w => w.english !== currentWord.english);
            
            while (options.length < 4 && otherWords.length > 0) {
                const randomIndex = Math.floor(Math.random() * otherWords.length);
                const randomWord = otherWords.splice(randomIndex, 1)[0];
                options.push(randomWord.english);
            }
            
            // Shuffle options
            options.sort(() => Math.random() - 0.5);
            
            const optionsHtml = options.map((option, index) => `
                <button onclick="selectAnswer('${option}', '${currentWord.english}')" 
                        class="w-full p-4 text-left bg-gray-50 hover:bg-blue-50 rounded-xl border border-gray-200 hover:border-blue-300 transition-all duration-200 option-btn">
                    ${option}
                </button>
            `).join('');
            
            document.getElementById('quizOptions').innerHTML = optionsHtml;
            document.getElementById('quizResult').classList.add('hidden');
            document.getElementById('quizControls').classList.remove('hidden');
            document.getElementById('nextButton').classList.add('hidden');
            quiz.answered = false;
        }

        function selectAnswer(selected, correct) {
            if (currentQuiz.answered) return;
            
            currentQuiz.answered = true;
            const buttons = document.querySelectorAll('.option-btn');
            
            buttons.forEach(btn => {
                btn.disabled = true;
                if (btn.textContent.trim() === correct) {
                    btn.classList.add('bg-green-100', 'border-green-500', 'text-green-800');
                } else if (btn.textContent.trim() === selected && selected !== correct) {
                    btn.classList.add('bg-red-100', 'border-red-500', 'text-red-800');
                } else {
                    btn.classList.add('opacity-50');
                }
            });
            
            if (selected === correct) {
                currentQuiz.score++;
            }
            
            document.getElementById('nextButton').classList.remove('hidden');
        }

        function nextQuestion() {
            currentQuiz.currentQuestion++;
            
            if (currentQuiz.currentQuestion >= currentQuiz.totalQuestions) {
                showQuizResult();
            } else {
                showQuestion();
            }
        }

        function showQuizResult() {
            const quiz = currentQuiz;
            const percentage = Math.round((quiz.score / quiz.totalQuestions) * 100);
            
            let resultIcon, resultText;
            if (percentage >= 80) {
                resultIcon = 'üéâ';
                resultText = 'Excellent!';
            } else if (percentage >= 60) {
                resultIcon = 'üëè';
                resultText = 'Good job!';
            } else {
                resultIcon = 'üí™';
                resultText = 'Keep practicing!';
            }
            
            document.getElementById('resultIcon').textContent = resultIcon;
            document.getElementById('resultText').textContent = resultText;
            document.getElementById('finalScore').textContent = `You scored ${quiz.score} out of ${quiz.totalQuestions}! (${percentage}%)`;
            
            document.getElementById('quizResult').classList.remove('hidden');
            document.getElementById('quizControls').classList.add('hidden');
        }

        function restartQuiz() {
            if (currentQuiz) {
                startQuiz(currentQuiz.category);
            }
        }

        function closeQuiz() {
            document.getElementById('quizModal').classList.add('hidden');
            document.getElementById('quizModal').classList.remove('flex');
            currentQuiz = null;
        }

        // Load vocabulary when page loads
        window.addEventListener('load', loadVocabulary);
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97cab7aa30ccfed0',t:'MTc1NzQ2MzE4NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>

